# JWT Keychain ‚õì
[![Swift Version](https://img.shields.io/badge/Swift-4.1-brightgreen.svg)](http://swift.org)
[![Vapor Version](https://img.shields.io/badge/Vapor-3-30B6FC.svg)](http://vapor.codes)
[![Vapor Version](https://img.shields.io/badge/Vapor-2-F6CBCA.svg)](http://vapor.codes)
[![Circle CI](https://circleci.com/gh/nodes-vapor/jwt-keychain/tree/master.svg?style=shield)](https://circleci.com/gh/nodes-vapor/jwt-keychain)
[![codebeat badge](https://codebeat.co/badges/04ee1891-95e9-483e-99c1-44a9191d1d8a)](https://codebeat.co/projects/github-com-nodes-vapor-jwt-keychain-master)
[![codecov](https://codecov.io/gh/nodes-vapor/jwt-keychain/branch/master/graph/badge.svg)](https://codecov.io/gh/nodes-vapor/jwt-keychain)
[![Readme Score](http://readme-score-api.herokuapp.com/score.svg?url=https://github.com/nodes-vapor/jwt-keychain)](http://clayallsopp.github.io/readme-score?url=https://github.com/nodes-vapor/jwt-keychain)
[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://raw.githubusercontent.com/nodes-vapor/jwt-keychain/master/LICENSE)

Add a complete and customizable user authentication system for your API project.

## Demo project

https://github.com/nodes-vapor/jwt-keychain-demo

## üì¶ Installation

Update your `Package.swift` file.

```swift
.package(url: "https://github.com/nodes-vapor/jwt-keychain.git", from: "1.0.0")
```
```swift
targets: [
    .target(
        name: "App",
        dependencies: [
            ...
            "JWTKeychain"
        ]
    ),
    ...
]
```

## Getting started üöÄ

TODO

### Resources

Copy package resources:

Move the content of `JWTKeychain/Resources/Views` into the `Resources/Views` folder of your project. Unfortunately there's no convenient to this at the moment, but one option is to download this repo as a zip and then move the folders into the root of your project. Remember to check that you're not overwriting any files in your project.

See `https://github.com/vapor/jwt` to learn more about signing.

### Usage

```swift
import JWTKeychain
```

### Token Generator Command
In order to generate password reset tokens for users add the following to `droplet.json`'s `commands`: `"keychain:generate_token"`. Then you can create a token like so:

> `drop --run keychain:generate_token user@email.com`

## Tokens
There are three types of tokens used by JWTKeychain: refresh tokens, API access tokens, and password reset tokens.

Both refresh and access tokens should be included in the `Authorization` header for each request they are needed for, as follows: `Authorization: Bearer TOKEN` (where `TOKEN` is replaced with the actual token string).

### Refresh Tokens

> Usage of this type of token is optional but recommended for extra security. You can opt-out of using refresh tokens by omitting the value for `refreshToken` in `jwt-keychain.json`.

Refresh tokens are tokens with a long expiration time that can be used to generate the more short-lived access tokens that are needed for API access.

Refresh tokens are returned when logging in and when signing up* as a string under the key: `refreshToken`. They can only be used to create new access tokens at the `/users/regenerate` endpoint.

When a refresh token expires a new one can be generated by logging in using the user's credentials.

\* Besides the refresh token, an access token and the user object are also returned as a convenience to the client developer.

### API Access Tokens

API Access tokens give access to the following endpoints:
* GET `/users/me`
* GET `/users/logout`
* PATCH `/users/update`

TODO: add other routes

Whenever an access token is expired a new one can be generated using a request to `/users/regenerate`.

### Password Reset Tokens

TODO: explain

## Customization

TODO:

### API Requests

TODO:

### Frontend Requests

TODO:

### Supply Additional Middleware

TODO:

## üèÜ Credits

This package is developed and maintained by the Vapor team at [Nodes](https://www.nodesagency.com).

## üìÑ License

This package is open-sourced software licensed under the [MIT license](http://opensource.org/licenses/MIT)
